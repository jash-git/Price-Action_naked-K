function brthrottle(){var FIX=4,REVISE=20,elems=document.querySelectorAll('div[id^="br_"]'),sawElems=[];return function(){return sawElems.length===elems.length?(window.onscroll=null,!0):(elems.forEach(function(el){if(sawElems.indexOf(el)<0){var brBox=el.getBoundingClientRect();if(0===brBox.width||0===brBox.height||"0"===el.style.opacity)return!1;var winH=window.innerHeight||document.documentElement.clientHeight,eleH=el.offsetHeight/FIX,diff=winH-brBox.top-REVISE-eleH;if(0<diff){sawElems.push(el);var fit=document.querySelectorAll('span[id^="url_'+el.id+'"]'),ct=eval(el.id+"_tc");if(0<fit.length){var temp=fit[0].id.split("__");""===ct?$("<img/>").attr({"src":"//mercury.books.com.tw/logs/brv/_bt.gif?brid="+temp[1],"referrerpolicy":"unsafe-url"}):$("<img/>").attr({"src":"//mercury.books.com.tw/logs/brv/_bt.gif?brid="+temp[1]+"&a="+ct.a+"&t="+ct.t+"&i="+ct.i,"referrerpolicy":"unsafe-url"})}}}}),!1)}}function prodclick(e,t){var i=e.ecommerce.impressions[t];dataLayer.push({event:"EEProdClick",ecommerce:{click:{actionField:{list:i.list},products:[{name:i.name,id:i.id,price:i.price,category:i.cat,position:i.position}]}}})}function prodremovecart(e){dataLayer.push({event:"EEProdRemoveCart",ecommerce:{remove:{products:[{name:e.name,id:e.id,price:e.price,category:e.cat}]}}})}